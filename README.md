# Бот для автопостинга из группы VK в канал Telegram

Бот автоматически мониторит выбранную группу ВКонтакте на новые записи и перепостит их в указанный канал Telegram. 
Его можно настроить, изменив переменные в файле `.env`
- ВК-ссылки преобразуются в обычный текст
- Параметр включать ссылки в текст или игнорировать их
- Параметр делиться перепостами, при этом текст основного поста и текст перепоста в телеграмме компонуются в общий, но с указанием автора перепоста
- Текст автоматически разбивается по 4096 символ в посте Telegram
- Фотографии автоматически разбиваются по 10 фото за раз
- В связи с ограничениями запросов Telegram, большие блоки данных отправляются каждые 60 секунд
- Проверка на новые посты в VK происходит каждый час
- Логгер записывает ход работы в файл `app.log`
- Видео из VK пока не перебрасывается, при включенных ссылках добавляется указание о видео по ссылке ниже

Пример автопостинга в конце страницы

## Требования

Для успешной настройки и запуска бота вам потребуется:

- Python 3.10
- Пакеты Python, указанные в `requirements.txt`
- [Сервисный ключ доступа приложения ВК](https://vk.com/apps?act=manage)
- [Токен вашего tg bot](https://t.me/BotFather), подключенного администратором в вашем Telegram канале


## Установка и настройка

1. Клонируйте этот репозиторий на свой сервер:

    ```bash
    git clone https://github.com/Roodootoo/bot_vk_to_tg.git
    ```

2. Перейдите в каталог с проектом:

    ```bash
    cd bot_vk_to_tg
    ```

3. Создайте и активируйте виртуальное окружение:

    ```bash
    python -m venv venv
    source venv/bin/activate
    ```

4. Установите зависимости:

    ```bash
    pip install -r requirements.txt
    ```

5. Скопируйте файл `.env.example` и переименуйте его в `.env`. Заполните необходимые переменные окружения:

    ```dotenv
    VK_TOKEN=ВАШ_СЕРВИСНЫЙ_КЛЮЧ_ДОСТУПА_ВК
    BOT_TOKEN=ВАШ_ТОКЕН_ТЕЛЕГРАМ
    CHANNEL=ИМЯ_КАНАЛА_ТЕЛЕГРАМ (@example)
    DOMAIN_VK=ДОМЕН_ГРУППЫ_ВК (example.domain)
    COUNT_VK=КОЛИЧЕСТВО_ПОСТОВ_ДЛЯ_ПОДПИСКИ
    INCLUDE_LINK=ДОБАВЛЯТЬ_ССЫЛКИ_В_ТЕКСТ_ПОСТА (boolean)
    PREVIEW_LINK=ДОБАВЛЯТЬ_ПРЕВЬЮ (boolean)
    REPOSTS=ВКЛЮЧАТЬ_ПЕРЕПОСТЫ_ИЗ_ВК (boolean)
    ```

    Замените `ВАШ_ТОКЕН_ВК`, `ВАШ_ТОКЕН_ТЕЛЕГРАМ`, `ИМЯ_КАНАЛА_ТЕЛЕГРАМ`, `ДОМЕН_ГРУППЫ_ВК` и другие значения на свои.


6. Запустите бота:

    ```bash
    python main.py 
    ```

7. Для запуска в контейнере:

    ```bash
    docker-compose up --build
    ```

## Пример ВК-поста с перепостом
![](example.jpg)